clear
clc

[CrossSection_DataSource, Surface_Sources_type, Spatial_distribution, Number_of_histories, Tallies] = Input(); %% can be designed by manually input
[Macroscopic_Cross_Sections, Surface_Sources] = CrossSection(CrossSection_DataSource); 

Number_of_histories_test = 1000:2000:10000;
Zeroth_spatial_mement_scalar_different_NumOfHis = zeros(length(Spatial_distribution.Thickness), Number_of_histories_test);
First_angular_mement_different_NumOfHis = zeros(length(Spatial_distribution.Thickness), Number_of_histories_test);

for i = 1:length(Number_of_histories_test) 
    
    Number_of_histories = Number_of_histories_test(i);
    [Spatial_Material_Parameter, Strength_Probablity_kind, Strength_Probablity_kind_effective, Zeroth_spatial_mement_scalar_flux, First_angular_mement, Current_on_the_right_surface, First_spatial_moment, stand_deviation_Zeroth_spatial_mement_scalar_flux, stand_deviation_First_angular_moment] = Solver(Macroscopic_Cross_Sections, Surface_Sources, Surface_Sources_type, Spatial_distribution, Number_of_histories, Tallies);
    
    Zeroth_spatial_mement_scalar_different_NumOfHis(:,i) =  Zeroth_spatial_mement_scalar_flux;
    First_angular_mement_different_NumOfHis(:,i) = First_angular_mement;
end

% Zeroth_spatial_mement_scalar_flux
% First_angular_mement
% Current_on_the_right_surface
% First_spatial_moment



% X = categorical(Spatial_Material_Parameter.Row);
% X = reordercats(X,Spatial_Material_Parameter.Row);
% 
% figure(1);bar(X, Zeroth_spatial_mement_scalar_flux)
% figure(2);bar(X, First_angular_mement)
% figure(3);bar(X, stand_deviation_Zeroth_spatial_mement_scalar_flux)
% figure(4);bar(X, stand_deviation_First_angular_moment)

% figure(1);bar(Spatial_Material_Parameter.Material_right_boundary, Zeroth_spatial_mement_scalar_flux)
% figure(2);bar(Spatial_Material_Parameter.Material_right_boundary, First_angular_mement)
% 
% figure(3);bar(Spatial_Material_Parameter.Material_right_boundary, stand_deviation_Zeroth_spatial_mement_scalar_flux)
% figure(4);bar(Spatial_Material_Parameter.Material_right_boundary, stand_deviation_First_angular_moment)